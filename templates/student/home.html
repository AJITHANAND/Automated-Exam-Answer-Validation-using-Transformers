<!DOCTYPE html>
{% load static %}
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Student Home</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/bootstrap-material-design@4.1.1/dist/css/bootstrap-material-design.min.css"
      integrity="sha384-wXznGJNEXNG1NFsbm0ugrLFMQPWswR3lds2VeinahP8N0zJw9VWSopbjv2x7WCvX"
      crossorigin="anonymous"
    />
    <link
      href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons"
    />
    <link
            rel="stylesheet"
            type="text/css"
            href ={% static 'css/home.css' %}
    />
  </head>
  <body>
    <div class="container">
      <div class="row title">
        <div class="col-8">
            <h3>Welcome to Online Exam Portal</h3>
        </div>
         {% if logged %}
             <div class="col-3">
                 <h3>Logged as,{{ Name }}</h3>
             </div>
             <div class="col-1 mt-4">
                 <button onclick="log_out()" class="btn-21">LogOut</button>
             </div>
         {% endif %}
      </div>
      <div class="row mt-4">
        <div class="col-lg-2 col-md-6">
          <button
            class="btn btn-block btn-primary"
            data-toggle="modal"
            data-target="#myModal"
          >
            <i class="material-icons">library_books</i> Classic
            <div class="ripple-container"></div>
          </button>
        </div>
        <div class="col-lg-2 col-md-6">
          <button
            class="btn btn-block btn-primary"
            id="btnLogin"
            data-toggle="modal"
            data-target="#loginModal"
          >
            <i class="material-icons">tab</i>
            check results
            <div class="ripple-container"></div>
          </button>
        </div>
        <div class="col-lg-2 col-md-6">
          <button
            class="btn btn-block btn-primary"
            onclick='redirectL()'
          >
            <i class="material-icons">create</i>
            Take Exam
            <div class="ripple-container"></div>
          </button>
        </div>
      </div>

      <div class="modal fade show" id="myModal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Exam</h5>
              <button
                type="button"
                class="close"
                data-dismiss="modal"
                aria-label="Close"
              >
                <i class="material-icons">clear</i>
              </button>
            </div>
            <div class="modal-body">
              <p>
                  Dear students,
                  We would like to remind you that malpractice during online examinations is strictly prohibited and will not be tolerated. We expect all students to uphold the highest standards of academic integrity and honesty.
                  To help prevent malpractice, please adhere to the following guidelines during your online examinations:

                  <ul>
                    <li>Do not attempt to cheat or access unauthorized resources during the examination. This includes using external devices, textbooks, notes, or communication with other individuals.</li>
                    <li>Do not plagiarize or copy content from external sources without proper citation or attribution.</li>
                    <li>Do not share your login credentials or allow anyone else to take the exam on your behalf.</li>

                    <li></li>
                  </ul>
                  If you are found to have engaged in malpractice during the examination, you may face serious consequences, including a failing grade, academic penalties, or even expulsion from the institution.
                  We trust that all students will approach their examinations with honesty and integrity, and we wish you the best of luck in your studies.
                  <br>Sincerely,<br>
                  HOD
              </p>
            </div>
            <div class="modal-footer">
{#              <button type="button" class="btn btn-link">Nice Button</button>#}
              <button
                type="button"
                class="btn btn-danger btn-link"
                data-dismiss="modal"
              >
                Close
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="modal fade show" id="loginModal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-login mt-5" role="document">
          <div class="modal-content">
            <div class="card card-signup card-plain">
              <div class="modal-header">
                <div class="card-header card-header-primary text-center">
                  <button
                    type="button"
                    class="close"
                    data-dismiss="modal"
                    aria-hidden="true"
                  >
                    <i class="material-icons">clear</i>
                  </button>
                  <h4 class="card-title">Log in</h4>
                  <div class="social-line">
                    <a href="#pablo" class="btn btn-just-icon btn-link">
                      <i class="fa fa-facebook-square"></i>
                    </a>
                    <a href="#pablo" class="btn btn-just-icon btn-link">
                      <i class="fa fa-twitter"></i>
                    </a>
                    <a href="#pablo" class="btn btn-just-icon btn-link">
                      <i class="fa fa-google-plus"></i>
                    </a>
                  </div>
                </div>
              </div>
              <div class="modal-body">
                <form class="form" method="" action="">
                  <p class="description text-center">Or Be Classical</p>
                  <div class="card-body">
                    <div class="form-group bmd-form-group">
                      <div class="input-group">
                        <div class="input-group-prepend">
                          <span class="input-group-text">
                            <i class="material-icons">mail</i>
                          </span>
                        </div>
                        <input
                          type="text"
                          class="form-control"
                          placeholder="Email..."
                          id="emailInput"
                        />
                      </div>
                    </div>

                    <div class="form-group bmd-form-group">
                      <div class="input-group">
                        <div class="input-group-prepend">
                          <span class="input-group-text">
                            <i class="material-icons">lock_outline</i>
                          </span>
                        </div>
                        <input
                          type="password"
                          placeholder="Password..."
                          class="form-control"
                          id="passwordInput"
                        />
                      </div>
                    </div>
                  </div>
                </form>
              </div>
              <div class="modal-footer justify-content-center">
                <button id="getResult" class="btn btn-primary btn-link btn-wd btn-lg"
                  >Check Results</button
                >
              </div>
            </div>
          </div>
        </div>
      </div>


    </div>

    <div class="container">
        <table  class="table table-striped table-dark">
            <thead>
                <tr>
                    <th scope="col">Que.No</th>
                    <th scope="col">Term</th>
                    <th scope="col">Question</th>
                    <th scope="col">Mark Scored</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
    <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://unpkg.com/popper.js@1.12.6/dist/umd/popper.js"
      integrity="sha384-fA23ZRQ3G/J53mElWqVJEGJzU0sTs+SvzG8fXVWP+kJQ1lwFAOkcUOysnlKJC33U"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://unpkg.com/bootstrap-material-design@4.1.1/dist/js/bootstrap-material-design.js"
      integrity="sha384-CauSuKpEqAFajSpkdjv3z9t8E7RlpJ1UP0lKM/+NdtSarroVKu069AlsRPKkFBz9"
      crossorigin="anonymous"
    ></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
  <script>
      function redirectL(){
          location.href="{% url 'student_login' %}";
      }

      function log_out(){
          location.href ="{% url 'student_logout' %}";
      }

      $(document).on('click', '#getResult', function() {

          let email = $('#emailInput').val();
          let password = $('#passwordInput').val();

          $.ajax({
              url: "{% url 'answer_analysis' %}",
              type: "GET",
              data: {
                  'email':email,
                  'password':password
              },
              dataType: "json",
              success: (data) => {
                  console.log(data);
                  // select the table and clear its content
                  let table = $('.table');
                  table.find('tbody').empty();

                  let totalScore = 0;

                  // iterate through the data and append rows to the table
                  for (let i = 0; i < data.context.length; i++) {
                      console.log(data.context[i]['mark'])
                      let row = '<tr>' +
                          '<td>' + (i+1) + '</td>' +
                          '<td>' + data.context[i]['term'] + '</td>' +
                          '<td>' + data.context[i]['question'] + '</td>' +
                          '<td>' + data.context[i]['mark'].toFixed(2) + '</td>' +
                          '</tr>';
                      table.append(row);
                      totalScore += data.context[i]['mark'];
                  }
                  // add a row at the end with the total score
                  let totalRow = '<tr>' +
                      '<td colspan="3">Total Scored:</td>' +
                      '<td>' + totalScore.toFixed(2) +'/'+data.context.length*2 + '</td>' +
                      '</tr>';
                  table.append(totalRow);
              },
              error: (error) => {
                  console.log("err test");
                  console.log(error);
              }
          });
      });


  </script>
  </body>
</html>
